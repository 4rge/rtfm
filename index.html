<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R.T.F.M.</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #1e1e1e;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        h1 {
            color: #e0e0e0;
            text-align: center;
        }
        label {
            font-weight: bold;
            color: #e0e0e0;
        }
        input, textarea {
            padding: 10px;
            font-size: 14px;
            border: 1px solid #444444;
            border-radius: 5px;
            background-color: #333333;
            color: #c0c0c0;
            transition: border-color 0.3s;
        }
        input:focus, textarea:focus {
            border-color: #e0e0e0;
            outline: none;
        }
        #program-name {
            width: calc(100% - 150px - 10px);
        }
        #description {
           width: calc(100% - 150px - 10px);
           font-size: 16px; /* Change this value to adjust font size */
           border-color: #0088cc; /* Change border color */
           padding: 5px
        }
        #functionality-notes {
           width: calc(100% - 150px - 10px); /* Ensures it takes a majority of the width */
           height: 120px; /* Change this value to adjust the height */
           padding: 10px; /* Additional padding for aesthetics */
           font-size: 14px; /* Font size */
        }
        #see-also {
           width: calc(100% - 150px - 10px); /* Same width adjustment */
           height: 120px; /* Change this value to adjust the height */
           padding: 10px; /* Additional padding for consistent look */
           font-size: 14px; /* Font size */
        }
        .remove-button {
           color: #ff4444;
           border: none;
           cursor: pointer;
           font-weight: bold;
           padding: 0 10px;
           margin-left: 15px; /* Add left margin to add spacing */
           background-color: #444444;
           border-radius: 5px;
           transition: background-color 0.3s;
        }
        .remove-button:hover {
            background-color: #ff4444;
        }
        .options-summary {
            background-color: #222222;
            border: 1px solid #444444;
            border-radius: 5px;
            padding: 10px;
            max-width: 250px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            position: absolute;
        }
        .toggle-button {
            background-color: #444444;
            color: #66ccff;
            border: 1px solid #666666;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .toggle-button:hover {
            background-color: #666666;
        }
        pre {
            background-color: #1e1e1e;
            padding: 10px;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 400px;
            overflow-y: auto;
            color: #c0c0c0;
            border-radius: 5px;
            border: 1px solid #444444;
        }
        .example-command {
            width: calc(100% - 60px);
        }
        .option-container {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .option-flag, .option-description {
        /* Add or adjust height value as needed */
            height: 40px; /* Example height */
            padding: 10px; /* Padding to increase the clickable area */
            font-size: 14px; /* Ensure the font size matches your UI design */
            border-radius: 5px; /* Keep rounded corners */
            border: 1px solid #444444; /* Consistent border */
            background-color: #333333; /* Background color */
            color: #c0c0c0; /* Text color */
            transition: border-color 0.3s; /* Transition for focus effect */
        }
        .option-flag:focus, .option-description:focus {
            border-color: #66ccff; /* Change border color on focus */
            outline: none; /* Remove default outline */
        }
        .option-description {
            width: calc(80% - 65px);
            padding: 10px
        }
        input[type="text"], input[type="checkbox"] {
            margin-bottom: 10px;
        }
        .additional-input {
            display: none;
        }
    </style>
</head>
<body>
    <h1>R.T.F.M.</h1>
    <div class="d-flex justify-content-between align-items-center">
        <img src="https://www.bootstrapdash.com/demo/bootstrap-admin-template-light/assets/images/favicon.png" alt="Options" style="width: 30px; height: 30px;">
        <button class="toggle-button" onclick="toggleOptionsMenu()">Toggle Options Menu</button>
    </div>
    <div class="options-summary" id="options-summary">
        <h4>Options Settings</h4>
        <table>
            <tr>
                <td><input type="checkbox" id="functionality-notes-checkbox" onchange="toggleTextarea('functionality-notes')"> Include Functionality Notes</td>
            </tr>
            <tr>
                <td><input type="checkbox" id="see-also-checkbox" onchange="toggleTextarea('see-also')"> Include 'See Also' References</td>
            </tr>
        </table>
    </div>
        <script>
            window.onload = function () {
                document.getElementById("functionality-notes-checkbox").checked = false; // Ensure it's unchecked
                document.getElementById("see-also-checkbox").checked = false; // Ensure it's unchecked
         };
        </script>
    <div class="input-row">
        <label for="program-name">Program Name:</label>
        <input type="text" id="program-name" placeholder="Enter the program name" oninput="updateManPage()">
    </div>
    <div class="input-row">
        <label for="description">Description:</label>
        <textarea id="description" placeholder="Enter a short description" oninput="updateManPage()"></textarea>
    </div>
    <div class="input-row">
        <label for="version">Version:</label>
        <input type="text" id="version" placeholder="Enter the version number" oninput="updateManPage()">
        <label for="date">Date:</label>
        <input type="text" id="date" placeholder="YYYY-MM-DD (leave blank for today's date)" oninput="updateManPage()">
    </div>
    <label for="exit-status">Exit Status:</label>
    <textarea id="exit-status" placeholder="Enter the exit status description" rows="1" oninput="updateManPage()"></textarea>

    <h3>Options:</h3>
    <div id="options-container">
        <div class="option-container">
            <input type="text" class="option-flag" placeholder="Option flag (e.g. -h)" onkeyup="handleOptionEnter(event, this)">
            <input type="text" class="option-description" placeholder="Option description" onkeyup="handleOptionEnter(event, this)">
            <button class="remove-button" onclick="addOption('', '')">✚</button>
        </div>
    </div>

    <h3>Examples:</h3>
    <div id="examples-container">
        <div class="example">
            <input type="text" id="example-command" class="example-command" placeholder="Example command" onkeyup="handleExampleEnter(event, this)">
            <button class="remove-button" onclick="addExample('')">✚</button>
        </div>
    </div>
    
    <div class="additional-input" id="functionality-notes-container">
        <label for="functionality-notes">Functionality Notes:</label>
        <textarea id="functionality-notes" placeholder="Enter functionality notes" rows="1" oninput="updateManPage()"></textarea>
    </div>

    <div class="additional-input" id="see-also-container">
        <label for="see-also">See Also References:</label>
        <textarea id="see-also" placeholder="Enter 'See Also' references" rows="1" oninput="updateManPage()"></textarea>
    </div>

    <div id="manpage-widget">
        <label>Generated Man Page:</label>
        <pre id="conversion-command-output"></pre>
        <pre id="man-page-output"></pre>
        <button class="toggle-button" id="download-button" onclick="downloadManPage()">Download Man Page</button> 
    </div>

    <script>
        function toggleTextarea(textareaId) {
            const container = document.getElementById(textareaId + '-container');
            container.style.display = document.getElementById(textareaId + '-checkbox').checked ? 'block' : 'none';
            updateManPage();
        }
        
        function toggleOptionsMenu() {
            const optionsMenu = document.getElementById('options-summary');
            optionsMenu.style.display = optionsMenu.style.display === 'block' ? 'none' : 'block';
        }

        function addOption(flag, description) {
            const optionsContainer = document.getElementById('options-container');
            const div = document.createElement('div');
            div.className = 'option-container';
            div.innerHTML = `
                <input type="text" class="option-flag" value="${flag}" onkeyup="handleOptionEnter(event, this)">
                <input type="text" class="option-description" value="${description}" onkeyup="handleOptionEnter(event, this)">
                <button class="remove-button" onclick="removeOption(this)">✖</button>
            `;
            optionsContainer.appendChild(div);
            updateManPage();
        }

        function addExample(command) {
            const examplesContainer = document.getElementById('examples-container');
            const div = document.createElement('div');
            div.className = 'example';
            div.innerHTML = `
                <input type="text" class="example-command" value="${command}" onkeyup="handleExampleEnter(event, this)">
                <button class="remove-button" onclick="removeExample(this)">✖</button>
            `;
            examplesContainer.appendChild(div);
            updateManPage();
        }

        function handleOptionEnter(event, input) {
            if (event.key === 'Enter') {
                const optionFlag = input.parentElement.querySelector('.option-flag').value;
                const optionDescription = input.parentElement.querySelector('.option-description').value;
                if (optionFlag || optionDescription) {
                    addOption(optionFlag, optionDescription);
                    input.parentElement.querySelector('.option-flag').value = '';
                    input.parentElement.querySelector('.option-description').value = '';
                    updateManPage();
                }
            }
        }

        function handleExampleEnter(event, input) {
            if (event.key === 'Enter') {
                const exampleCommand = input.value;
                if (exampleCommand) {
                    addExample(exampleCommand);
                    input.value = '';
                }
                updateManPage();
            }
        }

        function removeOption(button) {
            button.parentElement.remove();
            updateManPage();
        }

        function removeExample(button) {
            button.parentElement.remove();
            updateManPage();
        }

        function updateManPage() {
            const programName = document.getElementById('program-name').value;
            const description = document.getElementById('description').value;
            const version = document.getElementById('version').value;
            const date = document.getElementById('date').value || new Date().toISOString().split('T')[0];
            const exitStatus = document.getElementById('exit-status').value;
            const functionalityNotes = document.getElementById('functionality-notes-checkbox').checked 
                ? document.getElementById('functionality-notes').value : '';
            const seeAlso = document.getElementById('see-also-checkbox').checked 
                ? document.getElementById('see-also').value : '';

            let optionsText = "";
            const optionFlags = document.getElementsByClassName('option-flag');
            const optionDescs = document.getElementsByClassName('option-description');

            for (let i = 0; i < optionFlags.length; i++) {
                if (optionFlags[i].value && optionDescs[i].value) {
                    optionsText += `.B ${optionFlags[i].value}\n${optionDescs[i].value}\n`;
                }
            }

            let examplesText = "";
            const exampleCommands = document.getElementsByClassName('example-command');

            for (let i = 0; i < exampleCommands.length; i++) {
                if (exampleCommands[i].value) {
                    examplesText += `.B ${exampleCommands[i].value}\n`;
                }
            }

            let manPageContent = `
.TH ${programName.toUpperCase()} 1 "${date}" "${version}" "${programName} manual"
.SH NAME
${programName} - ${description}
.SH SYNOPSIS
.B ${programName}
[options]
.SH DESCRIPTION
${description}
${functionalityNotes ? `.SH FUNCTIONALITY NOTES\n${functionalityNotes}` : ''}
.SH OPTIONS
${optionsText}
.SH EXAMPLES
${examplesText}
${seeAlso ? `.SH SEE ALSO\n${seeAlso}` : ''}`;

            manPageContent = manPageContent.trim();
            document.getElementById('man-page-output').textContent = manPageContent;

            const conversionCommand = `groff -Tascii -man ${programName}.1 > ${programName}.txt`;
            document.getElementById('conversion-command-output').textContent = conversionCommand;
        }

        function downloadManPage() {
            const programName = document.getElementById('program-name').value;
            const manPageContent = document.getElementById('man-page-output').textContent;
            const blob = new Blob([manPageContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${programName}.1`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
